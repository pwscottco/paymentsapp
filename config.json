{"icon":"other","splash":"other","splashdata":{"bg":"#ffffff","img":"scottco_app2.png"},"settings":{"router":{"mode":"intelligent","animation":"off"},"theme":"","push-notifications":{"android":{"enabled":false},"ios":{"enabled":false}},"provisioning":{"enabled":false,"manifest":"","poll":2,"manual":false,"wifionly":true},"crashReporting":{"enabled":false,"androidEnabled":false,"iosEnabled":false,"splunkAndroidApiKey":"","splunkIosApiKey":"","splunkExtraData":""},"loading-message":true,"logging":{"enabled":false,"bufferFrequency":100,"defaultRootLogLevel":"error","defaultMaxFileSizeKilobyte":1000,"defaultMaxFiles":5,"appEnabled":true,"appUseDefault":true,"appRootLogLevel":"error","appMaxFileSizeKilobyte":1000,"appMaxFiles":5,"clientEnabled":true,"clientUseDefault":true,"clientRootLogLevel":"error","clientMaxFileSizeKilobyte":1000,"clientMaxFiles":5,"nativeEnabled":true,"nativeUseDefault":true,"nativeRootLogLevel":"error","nativeMaxFileSizeKilobyte":1000,"nativeMaxFiles":5},"plugins":{"builtIn":{"cordova-plugin-whitelist@1.2.2":{"override":false,"used":true,"enabled":true},"cordova-plugin-battery-status@1.1.2":{"override":false,"used":false,"enabled":false},"cordova-plugin-console@1.0.3":{"override":false,"used":true,"enabled":true},"cordova-plugin-contacts@2.1.0":{"override":false,"used":false,"enabled":false},"cordova-plugin-device@1.1.2":{"override":false,"used":true,"enabled":true},"cordova-plugin-device-motion@1.2.1":{"override":false,"used":false,"enabled":false},"cordova-plugin-device-orientation@1.0.3":{"override":false,"used":false,"enabled":false},"cordova-plugin-file@4.2.0":{"override":false,"used":true,"enabled":true},"cordova-plugin-geolocation@2.2.0":{"override":true,"used":false,"enabled":true},"cordova-plugin-globalization@1.0.3":{"override":false,"used":true,"enabled":true},"commontime-cordova-plugin-inappbrowser@1.6.2":{"override":false,"used":false,"enabled":false},"cordova-plugin-network-information@1.2.1":{"override":false,"used":false,"enabled":false},"cordova-plugin-splashscreen@3.2.2":{"override":false,"used":true,"enabled":true},"cordova-plugin-vibration@2.1.1":{"override":false,"used":false,"enabled":false},"cordova-plugin-statusbar@1.0.1":{"override":false,"used":true,"enabled":true},"cordova-plugin-camera@2.3.1":{"override":false,"used":false,"enabled":false},"phonegap-plugin-barcodescanner@6.0.4":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.thumbnail@1.4.8":{"override":false,"used":true,"enabled":true},"com.commontime.cordova.fileimporter@1.0.0":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.beacon@1.0.6":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.notification@1.0.11":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.audio@0.9.10":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.media-properties@1.2.11":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.splitscreen@1.1.0":{"override":false,"used":true,"enabled":true},"com.commontime.cordova.preferences@1.0.0":{"override":false,"used":true,"enabled":true},"com.commontime.cordova.authentication@1.0.8":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.urlhandler@1.1.0":{"override":false,"used":true,"enabled":true},"com.commontime.cordova.securesettings@1.0.2":{"override":false,"used":true,"enabled":true},"com.commontime.cordova.geofence@0.5.0":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.file-transfer@1.5.5":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.public.provisioning@0.0.13":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.insomnia@0.0.6":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.splunk-mint@1.0.3":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.kiosk@1.0.11":{"override":false,"used":false,"enabled":false},"cordova-android-movetasktoback@0.1.3":{"override":false,"used":true,"enabled":true},"com.commontime.cordova.logging@1.0.20":{"override":false,"used":true,"enabled":true},"cordova-plugin-email-composer":{"override":false,"used":true,"enabled":true},"com.commontime.cordova.public.messaging@0.0.38":{"override":false,"used":true,"enabled":true},"com.commontime.cordova.file-opener@1.0.8":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.logging@1.0.24":{"override":false,"used":true,"enabled":true},"cordova-plugin-email":{"override":false,"used":true,"enabled":true},"com.commontime.cordova.public.messaging@0.0.44":{"override":false,"used":true,"enabled":true}},"customPlugins":{}},"minimise-on-back-button":true},"language":{"defaultLocale":"en_GB","initialLanguage":"","useDeviceLocale":true},"metadata":{"version":"1.0.00","applicationkey":"ScottCoPayments","description":"Document serving application","title":"Service","apiaddress":"http://infinity.scottandco.uk.com:8000/api/service/","externaladdress":"http://infinity.scottandco.uk.com:8000/api/service/","internaladdress":"http://scottmdm02:8000/api/service/","ssladdress":"https://infinity.scottandco.uk.com/api/service/"},"name":"Service","version":"1.0.01","schemaVersion":22,"pages":[{"start":true,"name":"Search","config":[{"name":"On-Loaded Event","type":"event","item-type":"onloaded","_auto_id_":"eb094b56-871b-4f41-8e68-d67715b526a3","actions":[{"event":"onload","type":"inline-function","data":{"sync":true,"code":"if (cti.store.pages === undefined) {\n  cti.store.pages = { Settings: {UseSSL: true} }\n}\nif (cti.store.pages.Settings === undefined) {\n  cti.store.pages.Settings = { UseSSL: true }\n}\n\nif (!cti.store.pages.Settings.APIAddress) {\n  if (cti.store.pages.Settings.UseSSL) {\n  \tcti.store.pages.Settings.APIAddress = cti.store.schema.metadata.ssladdress;\n  }\n  else {\n  \tcti.store.pages.Settings.APIAddress = cti.store.schema.metadata.apiaddress;\n  }\n}\n\nif (!cti.store.Config || !cti.store.Config.companies) {\n  cti.utils.callAction('show-notification', { name: \"Info\", text: \"Please use the 'Settings' option below to configure the Service Application before first use.\" });\n\n}\n$success();"},"_auto_id_":"3c6d517f-55c6-4651-ab06-9e89fc7ab802","actions":[]},{"event":"onload","type":"call-function","data":{"name":"fnFilterCompanyLocations"},"_auto_id_":"d31507d4-5251-413c-949b-e1e299067092"}]}],"content":[{"name":"static_1","type":"area","item-type":"static","_auto_id_":"5891b649-dc68-47ff-87ae-05bc7261006b","content":[{"name":"image_logo","type":"media","item-type":"image-viewer","_auto_id_":"d29eebbc-4877-4930-99e7-9a1fba918a63","scaleImage":false,"maxWidth":200,"maxHeight":200,"fileName":"scottlogo_app2.png","expressions":{},"classes":"logo"}],"expressions":{}},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"row_AppName","type":"area","item-type":"row","_auto_id_":"5409d6f4-68f7-4210-a2af-47aa28de59c3","content":[{"name":"html_6","type":"content","item-type":"html","_auto_id_":"cfddc0f4-fcaf-4aba-a0f6-145df2276f4e","content":"<div>Scott+Co Service Application</div><p class=\"version\">Version: {{'$store.schema.version' | store }}</p>"}],"expressions":{}},{"name":"row_Company","type":"area","item-type":"row","_auto_id_":"d19ca621-339d-4d03-962e-8b40c7018ca3","content":[{"name":"Company","type":"choice","item-type":"select","_auto_id_":"aac820f2-381f-4cc6-b4de-28eddd67ac77","label":"Select Company","required":true,"options":[],"expressions":{},"option-source":"$store.Config.companies","label-property":"label","value-property":"value","validators":[],"actions":[{"event":"change","type":"call-function","data":{"name":"fnFilterCompanyLocations"},"_auto_id_":"7ad1050e-ad97-4cb5-a2c9-3dd080e296f6"}],"message":"Please select company"},{"name":"CompanyLocation","type":"choice","item-type":"select","_auto_id_":"23b0adfc-2eb6-4d52-b2e7-ecf08ef08edb","label":"Select Location","required":true,"options":[],"expressions":{"default":"\"0\""},"option-source":"$store.variables.FilterLocations","label-property":"label","value-property":"value","message":"Please select location"}],"expressions":{}},{"name":"row_search","type":"area","item-type":"row","_auto_id_":"0ade6737-0061-4967-b805-1aa4c73a1c46","content":[{"name":"MarkingInNumber","type":"user-input","item-type":"text","_auto_id_":"9da5a66e-dba2-4a1f-8980-e8a1a7f89f25","label":"","required":true,"multiline":false,"debounce":250,"message":"Please enter Marking In number","validators":[],"actions":[],"expressions":{},"placeholder":"Search for Marking In number..."},{"name":"btnSearchAction","type":"button","item-type":"button","_auto_id_":"e4004567-db05-43b7-8b09-94354e26d69c","content":"","theme":"minimal","actions":[{"event":"click","type":"call-function","data":{"name":"fnSubmitSearch"},"_auto_id_":"5f28bedd-201b-457d-a43d-ed09414907a9"}],"expressions":{"disabled":"$form.invalid"},"right-icon":"fa-search","classes":"iconButton"}],"expressions":{}}],"_auto_id_":"4f4f280b-aaf1-4e15-a799-d1bb8c56bd43","expressions":{},"classes":"nopadding"},{"name":"footer","type":"area","item-type":"button-bar","_auto_id_":"3d4a30b3-6516-41c7-a289-8ad0d8d291a2","extends":{"type":"area","item-type":"row"},"content":[{"name":"btnSettings","type":"button","item-type":"button","_auto_id_":"c647a559-ae93-46e9-9931-6ddc9b215330","content":"Settings...","theme":"minimal","expressions":{},"actions":[{"event":"click","type":"go-to-page","data":{"name":"Settings","isConditional":false},"_auto_id_":"8605523e-141f-4076-a0bb-3d04bf1738bf"}],"left-icon":"fa-gear","classes":"iconButton left"},{"name":"btnRefresh","type":"button","item-type":"button","_auto_id_":"9184e734-c0d4-4327-ac6d-8c1f14272af5","content":"Refresh","theme":"minimal","expressions":{},"actions":[],"left-icon":"fa-refresh","classes":"iconButton left"}],"expressions":{}},{"name":"staticContextMenu","type":"area","item-type":"static","_auto_id_":"cdc000a6-447a-435e-b8d8-cc08918eeab7","content":[{"name":"popNeedConfig","type":"component","item-type":"web-component","content":[{"name":"html_13","type":"content","item-type":"html","_auto_id_":"c8eaf408-43bf-4670-bf7a-a8e30292d21b","content":"<h3>Configuration needed...</h3>\n<p>Please enter your username and other relevant details before using the app. Use the \"Settings\" option at the bottom of the screen</p>"},{"name":"button_15","type":"button","item-type":"button","_auto_id_":"9984805a-2b6c-4493-982d-d8fd776ade27","content":"Continue","theme":"default","left-icon":"fa-check","actions":[{"event":"click","type":"call-function","data":{"name":"fnCancelPopup","params":{"popupId":"popNeedConfig"}},"_auto_id_":"a4c10fef-2e8b-4331-8da4-32b5f211ea1b"}],"expressions":{},"classes":"green"}],"componentId":"c04df03e-20ca-4f06-815b-ed42ca534a76","_auto_id_":"a33c5666-a4df-4fbc-8eec-0bd2e07fd0f8","attributes":{"id":"popNeedConfig"},"expressions":{}}],"expressions":{}}]},{"name":"ActionMessage","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"button_1","type":"button","item-type":"button","_auto_id_":"ed17a380-ac8d-409f-ac18-58cbd9e098be","content":"","theme":"minimal","actions":[{"event":"click","type":"go-back","data":{},"_auto_id_":"69126fed-da8c-44c4-bbd7-65ae6aa63f53"}],"left-icon":"fa-chevron-left","expressions":{},"classes":"iconButton"},{"name":"htmlPageTitle","type":"content","item-type":"html","_auto_id_":"e9c40529-5381-47e2-835e-9c705f09adac","content":"Search<p class=\"version\">{{'$store.Config.companyName' | store}}</p>","expressions":{}}],"_auto_id_":"487cbc27-7398-44d8-9766-49e9393e6b03"},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"htmlActionMessage","type":"content","item-type":"html","_auto_id_":"61283df7-e07d-4f1c-868b-da89d494eecd","content":"<h4>The requested Marking In detail is not available</h4><p>Reason: <b>{{'$store.api.ScottCo.markingin.data.reason' | store}}</b></p>","expressions":{}}],"_auto_id_":"0363e08b-e22a-439b-9eaf-163588202050"}],"start":false},{"name":"ConfirmDetails","config":[{"name":"On-Loaded Event","type":"event","item-type":"onloaded","_auto_id_":"939d78e6-5e00-4c58-a211-298087a0d94f","actions":[{"event":"onload","type":"inline-function","data":{"sync":true,"code":"var mapsApiKey = undefined;\nvar mapsScriptId = \"mapscript\";\ndebugger;\nif (cti.store.Config && cti.store.Config.mapsApiKey != \"pending\") {\n  mapsApiKey = cti.store.Config.mapsApiKey;\n}\n\nif (!mapsApiKey) {\n  mapsApiKey = 'AIzaSyDhnvmKC4i6e_yNoVP_BtcRWqphRsNaPyY';\n}\n\ndocument.getElementById(\"displayAddress\").innerHTML = cti.store.CurrentItem.fullAddress;\n//if ($(\"head script[src='https://maps.googleapis.com/maps/api/js?key=AIzaSyAJ5CO4zuiE1AL_M-uUoioigScCRiUjKoQ&callback=cti.function_init_map']\").length == 0) {\nif ($(\"head script[id='\"+mapsScriptId+\"']\").length == 0) {\n  console.log(\"Adding Google Maps API scripts\");\n  var s = document.createElement(\"script\");\n  s.type = \"text/javascript\";\n  //s.src = \"https://maps.googleapis.com/maps/api/js?key=AIzaSyAJ5CO4zuiE1AL_M-uUoioigScCRiUjKoQ&callback=cti.function_init_map\";\n  s.src = \"https://maps.googleapis.com/maps/api/js?key=\"+mapsApiKey+\"&callback=cti.function_init_map\";\n\ts.id = mapsScriptId;\n  // Use any selector\n  s.async = true;\n  s.defer = true;\n  $(\"head\").append(s);\n}\nelse {\n  console.log(\"Maps available, initialising\");\n\tcti.function_init_map();\n}"},"_auto_id_":"40bd6b64-ccac-4aed-bcd2-153417d939f0","actions":[]}]}],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"button_back","type":"button","item-type":"button","_auto_id_":"4f561231-ffd9-4eae-b6fd-96067a3146f6","content":"","theme":"minimal","actions":[{"event":"click","type":"go-to-page","data":{"name":"Search","isConditional":false},"_auto_id_":"7b7cd3ad-d246-40a1-85da-9d2f6329ffc6"}],"left-icon":"fa-chevron-left","expressions":{},"classes":"iconButton"},{"name":"html_2","type":"content","item-type":"html","_auto_id_":"8d865155-522d-42a6-aca4-ea4baed9ceb8","content":"Confirm Details<p class=\"version\">{{'$store.Config.companyName' | store}}</p>"},{"name":"button_ok","type":"button","item-type":"button","_auto_id_":"8742faea-2fff-4999-8de9-f5e98ffba404","content":"","theme":"minimal","actions":[{"event":"click","type":"go-to-page","data":{"name":"ActionDetail","isConditional":false},"_auto_id_":"1a897f0a-3be6-4bc1-86e7-c47135fc2ddd"}],"right-icon":"fa-check","expressions":{},"classes":"iconButton"}],"_auto_id_":"a98c0424-c62e-41e6-aca3-34bc738cb734"},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"htmlBanner","type":"content","item-type":"html","_auto_id_":"a7e4cd83-baf6-41cb-b9fa-57c7d6a89fe6","content":"Marking In Number: {{'$store.api.ScottCo.markingin.data.number' | store}}","expressions":{}},{"name":"htmlMap","type":"content","item-type":"html","_auto_id_":"69d898c4-f8ca-4bf5-b0f8-c5945cd48f2c","content":"<div class=\"container-fluid\">\n    <div class=\"row\">\n      <div id=\"mapcontainer\" class=\"col-xs-12\">\n        <div id=\"map_search\" class=\"embed-responsive\"></div>\n      </div>\n    </div>\n</div>","expressions":{}},{"name":"htmlActionDetails","type":"content","item-type":"html","_auto_id_":"ff99c85b-007d-46b4-bbc5-772c33644bda","content":"<div>\n</div><div><p class=\"item-label\">Pursuer</p>\n<p class=\"item-value\">{{'$store.api.ScottCo.markingin.data.pursuerName' | store}}</p>\n</div>\n<div><p class=\"item-label\">Address</p>\n<p class=\"item-value\" id=\"displayAddress\"></p>\n</div>\n<div><p class=\"item-label\">Document</p>\n<p class=\"item-value\">{{'$store.CurrentItem.documentTypeName' | store}} - \"{{'$store.CurrentItem.documentName' | store}}\"</p>\n</div>\n<div><p class=\"item-label\">Defenders</p>\n<p class=\"item-value\">{{'$store.CurrentItem._defenders.length' | store}}</p>\n</div>\n","expressions":{}}],"_auto_id_":"6c4c3539-584e-4ec4-84b7-1192704de56d","expressions":{},"classes":"nopadding"}],"start":false},{"name":"ActionDetail","config":[{"name":"On-Loaded Event","type":"event","item-type":"onloaded","_auto_id_":"6771d1a1-d45c-4b10-b1b7-bc03ccc1713a","actions":[{"event":"onloaded","type":"call-function","data":{"name":"fnSetDefenders"},"_auto_id_":"796b65cb-da44-4757-9991-18c309088b57"}]}],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"button_4","type":"button","item-type":"button","_auto_id_":"d2d2a97a-0e37-470e-bc19-f14aab0cadb5","content":"","theme":"minimal","actions":[{"event":"click","type":"go-to-page","data":{"name":"ConfirmDetails","isConditional":false},"_auto_id_":"b34febf5-1a86-437e-9158-e77c3dc28ad8"}],"left-icon":"fa-chevron-left","expressions":{},"classes":"iconButton"},{"name":"html_3","type":"content","item-type":"html","_auto_id_":"1a939ed2-54b7-4086-b725-2f23db57984a","content":"Serve Documents<p class=\"version\">{{'$store.Config.companyName' | store}}</p>"}],"_auto_id_":"3deaa4a5-7e51-4f7f-9972-19d1ef7481fc","expressions":{}},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"htmlDetails","type":"content","item-type":"html","_auto_id_":"e9bbe095-3d65-4dc6-9ebc-b3b5f200ccd3","content":"<div><p class=\"item-label\">Sheriff Officer Number</p>\n<p class=\"item-value\">{{'$store.Config.soNumber' | store}} - {{'$store.Config.soName' | store}}</p>\n</div>\n<div><p class=\"item-label\">Witness Number</p>\n<p class=\"item-value\">{{'$store.Config.witnessNumber' | store}} - {{'$store.Config.witnessName' | store}}</p>\n</div>\n<p>NOTE If either the SO or Witness number are incorrect, please change them in \"Settings\"</p>\n<br/>\n<p class=\"item-value\">{{'$store.variables.DefenderTerm' | store}}</p>\n","expressions":{}},{"name":"list_1","type":"content","item-type":"list","_auto_id_":"cdde938c-ccd5-48a4-b840-0b6438e5f7ab","static":false,"model":"$store.CurrentItem.defenders","data":"[]","autoscroll":false,"search":"","order":false,"pagination":false,"content":[{"name":"html_7","type":"content","item-type":"html","_auto_id_":"ca9fa777-5eff-4709-b2fd-72286ffd9ac9","content":"<div class=\"defender-container defender-container-{{$data.$item.status}}\">\n<div class=\"defender-name\">{{$data.$item.name}}</div>\n<div class=\"defender-address\">{{$data.$item.fullAddress}}</div>\n<div class=\"defender-outcome\">{{$data.$item.outcomeSummary}}</div>\n</div>","expressions":{}}],"dataSource":"dynamic","expressions":{},"classes":"defender-list","theme":"","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.CurrentDefender = $data.$item;\nif (!cti.store.pages.DefenderOutcome) {\n  cti.store.pages.DefenderOutcome = {};\n}\nif (cti.store.CurrentDefender.status && cti.store.CurrentDefender.status == \"unavailable\") {\n  return false;\n  $success();\n}\n\n// Initialise the outcome option\ncti.store.pages.DefenderOutcome.Outcome = cti.store.CurrentDefender.outcome;\n\ncti.utils.callAction(\"go-to-page\", { \"name\": \"DefenderOutcome\" });\n$success();"},"_auto_id_":"b0340d04-d7a3-4b20-88ec-ea6668a0ad68","actions":[]}]}],"_auto_id_":"c7fb9ac3-b4f3-4cbd-862a-62f519dedfc6"}],"start":false},{"name":"Settings","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_title","type":"content","item-type":"html","_auto_id_":"44b25e9c-218f-4f8d-8856-5f28d156c96b","content":"Settings","expressions":{}}],"_auto_id_":"73db1b04-c316-4ae3-9d02-e462dc05d05a"},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"SheriffOfficer","type":"user-input","item-type":"text","_auto_id_":"2235e9e5-b8ed-4581-9908-0fc02ad6f88d","label":"Sheriff Officer Name","required":false,"multiline":false,"debounce":250,"expressions":{}},{"name":"Witness","type":"user-input","item-type":"text","_auto_id_":"c150589c-a9c4-4c34-941c-e6e7c0d628e3","label":"Witness Name","required":false,"multiline":false,"debounce":250,"expressions":{}},{"name":"UseSSL","type":"choice","item-type":"switch","_auto_id_":"5462c319-b191-478a-bd9f-9495afe48171","label":"Use secure connection (HTTPS)","required":false,"on-text":"","off-text":"","actions":[{"event":"change","type":"inline-function","data":{"sync":true,"code":"if (cti.store.pages.Settings.UseSSL) {\n  cti.store.pages.Settings.APIAddress = cti.store.schema.metadata.ssladdress;\n}\nelse {\n  cti.store.pages.Settings.APIAddress = cti.store.schema.metadata.apiaddress;\n}\n"},"_auto_id_":"b4527d5c-ceee-4d1f-a04b-fb5f313ad8d0"}],"expressions":{},"validators":[]},{"name":"AdvancedSettings","type":"choice","item-type":"switch","_auto_id_":"ec80246a-ce56-4b1a-b109-cd66d3d34aa2","label":"Show advanced settings","required":false,"on-text":"","off-text":"","expressions":{},"validators":[],"actions":[]},{"name":"CompanyMode","type":"choice","item-type":"select","_auto_id_":"f8808bc3-3bf3-4f18-b07d-79d7a1d29fa4","label":"Operation mode","required":false,"options":[{"label":"Scott & Co","value":"1"},{"label":"Testing","value":"0"}],"expressions":{"default":"\"1\"","show":"$store.pages.Settings.AdvancedSettings===true"},"validators":[],"actions":[]},{"name":"APIAddress","type":"user-input","item-type":"text","_auto_id_":"8b548e5a-2cad-4a78-a04a-541fe3132430","label":"API Address","required":false,"multiline":false,"debounce":250,"description":"Please do not change this setting unless instructed. An incorrect setting will cause the app to not function.","left-icon":"fa-cloud","expressions":{"show":"$store.pages.Settings.AdvancedSettings===true"},"validators":[],"actions":[]}],"_auto_id_":"d9742405-80a9-46c5-87e2-25e7b855d1bb","expressions":{}},{"name":"footer","type":"area","item-type":"button-bar","_auto_id_":"67b4ac40-db35-4181-a088-a1c85fb193a7","extends":{"type":"area","item-type":"row"},"content":[{"name":"button_save","type":"button","item-type":"button","_auto_id_":"40a817fa-9684-4e69-b20f-5ac474b5ff39","content":"Save","theme":"default","actions":[{"event":"click","type":"call-actionflow","data":{"name":"VerifyConfig"},"_auto_id_":"3ff8f957-581d-4154-824d-088c1b9ee32a"}],"expressions":{},"classes":"button"}],"expressions":{}}],"start":false},{"start":false,"name":"DefenderOutcome","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"button_10","type":"button","item-type":"button","_auto_id_":"f991549f-cd8b-47ec-8316-990567c888ce","content":"","theme":"minimal","left-icon":"fa-chevron-left","actions":[{"event":"click","type":"go-back","data":{},"_auto_id_":"7659986b-a0a7-4dec-9c8a-81fae68e2809"}],"expressions":{},"classes":"iconButton"},{"name":"html_3","type":"content","item-type":"html","_auto_id_":"6d239bed-5eaf-48aa-a199-be77401bba8e","content":"Record Execution Details<p class=\"version\">{{'$store.Config.companyName' | store}}</p>"}],"_auto_id_":"17f6316d-dc17-4dbd-9904-393a218768c7","expressions":{}},{"name":"scrollable_1","type":"area","item-type":"scrollable","_auto_id_":"39be7f4b-d42f-415f-9f78-8d8e86cdbec4","content":[{"name":"htmlDefender","type":"content","item-type":"html","_auto_id_":"f3aadcd9-a185-4007-9ab1-78f6b5fd6c33","content":"<div><p class=\"item-label\">Name</p>\n<p class=\"item-value\">{{'$store.CurrentDefender.name' | store}}}</p>\n</div>\n<div><p class=\"item-label\">Address</p>\n<p class=\"item-value\">{{'$store.CurrentDefender.fullAddress' | store}}</p>\n</div>\n","expressions":{}},{"name":"btnNav","type":"button","item-type":"button","_auto_id_":"7b960941-a5c3-4da8-b038-8078b75bb963","content":"Navigate","theme":"default","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.utils.callAction(\"call-url\", { \"name\": \"GoogleMapping\", \"params\": { \"saddr\": \"current location\", \"daddr\": cti.store.CurrentDefender.fullAddress } });"},"_auto_id_":"aaf493b6-572d-44a6-8c0e-0dc7fb242ffc"}],"expressions":{},"classes":"inline-button","left-icon":"fa-road"},{"name":"Outcome","type":"choice","item-type":"select","_auto_id_":"c41ff5be-f6e5-4385-8f16-1c6e884ffa2d","label":"Outcome","required":false,"options":[],"option-source":"$store.Config.outcomeCodes","label-property":"label","value-property":"value","expressions":{"disabled":"$store.CurrentDefender.status=='complete' || $store.CurrentDefender.status=='pending' || $store.CurrentDefender.status=='failed' || $store.CurrentDefender.status=='unavailable'"}}]},{"name":"footer","type":"area","item-type":"button-bar","_auto_id_":"838aeefc-9a5c-46f4-a639-8d5011f7ccee","extends":{"type":"area","item-type":"row"},"content":[{"name":"btnSave","type":"button","item-type":"button","_auto_id_":"76f9fc19-7acb-4d21-94f2-1f5b10f7ce44","content":"Ok","theme":"default","expressions":{"show":"$store.CurrentDefender.status===undefined || ($store.CurrentDefender.status!='complete' && $store.CurrentDefender.status!='pending' && $store.CurrentDefender.status!='failed')"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"debugger;\nif (!cti.store.pages.DefenderOutcome.Outcome) {\n  console.log(\"outcome not selected\");\n  $fail();\n  return false;\n}\n\nfunction pad(param) {\n  var result = param.toString();\n  if (param < 10) { result = '0' + result; }\n  return result;\n}\n\nif (!cti.store.CurrentItem.service) {\n  cti.store.CurrentItem.service = {};\n}\n\nvar dt = new Date();\ncti.store.CurrentItem.service.serviceDate = dt.getFullYear().toString()+pad(dt.getMonth()+1)+pad(dt.getDate());\ncti.store.CurrentItem.service.serviceTime = pad(dt.getHours()) + pad(dt.getMinutes()) + pad(dt.getSeconds());\n\n\ncti.store.CurrentItem.service.soNumber = cti.store.Config.soNumber;\ncti.store.CurrentItem.service.witnessNumber = cti.store.Config.witnessNumber;\n\ncti.store.CurrentDefender.outcome = JSON.parse(JSON.stringify(cti.store.pages.DefenderOutcome.Outcome));\ncti.store.CurrentDefender.status = \"pending\";\ncti.store.CurrentDefender.outcomeSummary = cti.store.pages.DefenderOutcome.Outcome.label;\n\nif (navigator.geolocation && typeof navigator.geolocation.getCurrentPosition === \"function\") {\n  navigator.geolocation.getCurrentPosition(function(position) {\n    var pos = { lat: position.coords.latitude, lng: position.coords.longitude };\n    if (!cti.store.LocationHistory) {\n      cti.store.LocationHistory = [];\n    }\n    cti.store.CurrentItem.service.lat = position.coords.latitude;\n    cti.store.CurrentItem.service.lon = position.coords.longitude;\n    \n    //cti.store.LocationHistory.push({ \"location\": pos, \"date\": new Date() });\n    console.log(\"debug:: Curent location: \" + JSON.stringify(pos));\n    cti.utils.callAction(\"go-to-page\", { \"name\": \"ActionDetail\" });\n    $success();\n  }, function(err) {\n    console.log(\"debug:: Unable to get current position, acquisition failed: \" + JSON.stringify(err, null, 4));\n    cti.utils.callAction(\"go-to-page\", { \"name\": \"ActionDetail\" });\n    $success();\n  },\n  { enableHighAccuracy: true, timeout: 5000, maximumAge: 0 });\n}\nelse {\n  console.log(\"debug:: Unable to get current position, service not available\");\n  cti.utils.callAction(\"go-to-page\", { \"name\": \"ActionDetail\" });\n  $success();\n}\n"},"_auto_id_":"dc2f766b-8b02-41d8-b03f-14b0f63a7f57","actions":[{"event":"success","type":"call-actionflow","data":{"name":"SaveService"},"_auto_id_":"69abcbd8-d506-4bd1-95b6-f198379552fb"}]}],"left-icon":"fa-check","classes":"button"}],"expressions":{}}]}],"actionflows":[{"content":[{"type":"if","data":{},"_auto_id_":"3d332a13-ebd4-4f5c-bb71-84e0ac988048","operations":[{"type":"value","content":"{{$store.pages.Search.Company}}","$selected":false},{"type":"operator","content":"==","$selected":false},{"type":"value","content":"undefined","$selected":false}]},{"event":"click","type":"inline-function","data":{"sync":true,"code":"console.log(\"debug:: Unable to search\");"},"_auto_id_":"191aacf5-a048-44a9-b7df-d8602d4ee02f"},{"event":"click","type":"show-notification","data":{"options":{"schedule":false,"dynamic":true},"name":"Warning","title":"Required information missing","text":"Please enter the Marking In request you wish to search for"},"_auto_id_":"83eb9d04-a354-4a41-84de-d3ad49b0df4d"},{"type":"otherwise","data":{},"_auto_id_":"6061b345-6801-4e71-bad2-e73ac9277ec4"},{"event":"click","type":"inline-function","data":{"sync":true,"code":"console.log(\"debug:: Calling API\");\n$success();"},"_auto_id_":"cf472df0-cf78-471f-b1e9-5fb70c6be772","actions":[]},{"event":"click","type":"call-api","data":{"sync":true,"name":"ScottCo","operation":"markingin","params":{"actionId":"{{$store.pages.SearchForAction.ActionId}}","company":"{{$store.Config.company}}","companyId":"{{$store.Config.company}}","applicationkey":"{{$store.schema.metadata.applicationkey}}","companyNo":"{{$store.pages.Search.Company.value}}","locationNo":"{{$store.pages.Search.CompanyLocation.value}}","markingInNo":"{{$store.pages.Search.MarkingInNumber}}"}},"_auto_id_":"ddb1a130-936b-4cd6-8111-4a91e8f896e0","actions":[{"event":"fail","type":"show-notification","data":{"options":{"schedule":false,"dynamic":true},"name":"Warning","title":"Not available","text":"We weren't able to communicate and retrieve information about the Marking In request. Please try again later."},"_auto_id_":"20a14f2b-3b55-43ac-9335-ed3928bc2407"},{"event":"success","type":"call-function","data":{"name":"fnClearCurrentItem"},"_auto_id_":"15b61785-2c8c-456f-93e8-e53a86e4e971"},{"event":"success","type":"call-actionflow","data":{"name":"DisplayAction"},"_auto_id_":"e6bada7b-b399-4fba-bad9-e7e65dba3638"}]}],"name":"RequestAction"},{"content":[{"type":"if","data":{},"_auto_id_":"67783248-fb8b-4855-ab0c-523a13357bc0","operations":[{"type":"value","content":"{{$store.api.ScottCo.markingin.success}}","$selected":false},{"type":"operator","content":"==","$selected":false},{"type":"value","content":"true","$selected":false}]},{"event":"click","type":"call-function","data":{"name":"fnSetCurrentItem"},"_auto_id_":"4ad0623a-fec4-4a9b-bde7-a9a351b56ba4"},{"event":"click","type":"go-to-page","data":{"name":"ConfirmDetails","isConditional":false},"_auto_id_":"96cf0460-3fc6-49e2-a3b6-cb44a3b5e5f3"},{"type":"otherwise","data":{},"_auto_id_":"9633217e-1890-4c1e-be2f-815f6afe53d7"},{"event":"click","type":"go-to-page","data":{"name":"ActionMessage","isConditional":false},"_auto_id_":"e2a16872-1948-4e96-8e19-711b3d3648fe"}],"name":"DisplayAction"},{"content":[{"event":"click","type":"call-api","data":{"sync":true,"name":"ScottCo","operation":"getconfig","params":{"company":"{{$store.pages.Settings.CompanyMode.value}}","applicationkey":"{{$store.schema.metadata.applicationkey}}","companyId":"{{$store.pages.Settings.CompanyMode.value}}"}},"_auto_id_":"f7d91676-0f29-4280-a7c7-269bc37e1e90","actions":[{"event":"success","type":"call-function","data":{"name":"fnSaveSettings"},"_auto_id_":"e148e4e9-9f05-4378-b099-abab9e62813d"},{"event":"fail","type":"call-function","data":{"name":"fnSaveSettings"},"_auto_id_":"efe20883-f6f7-4e79-bbdd-bd29e0fe15c0"}]}],"name":"VerifyConfig"},{"content":[{"event":"click","type":"inline-function","data":{"sync":false,"code":"cti.store.variables.payload = {\n  markingIn: cti.store.CurrentItem.internalData,\n  defender: cti.store.CurrentDefender.internalData,\n  document: cti.store.CurrentItem.document,\n  service: cti.store.CurrentItem.service,\n  outcome: cti.store.CurrentDefender.outcome\n}\n  \ncti.utils.callAction(\"go-to-page\", { \"name\": \"ActionDetail\" });\n$success();"},"_auto_id_":"934bc717-8283-49b1-856e-3e543b89e370","actions":[]},{"event":"click","type":"call-offline-api","data":{"name":"ScottCoOffline","operation":"save","params":{"applicationkey":"{{$store.schema.metadata.applicationkey}}","companyId":"{{$store.Config.company}}","payload":"{{$store.variables.payload}}"}},"_auto_id_":"357a6fd3-86fb-4b9e-b376-a70f02dd45a1","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"var result = cti.store.offlineApi.ScottCoOffline.save;\n\nconsole.log(\"success >> \" + JSON.stringify(result));\n\n// we can only update stuff if we know all the info we need in the response\nif (result.data && result.data.payload && result.data.payload.markingIn && result.data.payload.defender) {\n  if (!cti.store.CurrentItem || !cti.store.CurrentItem.internalData) {\n    console.log(\"debug:: No currently active item to refer to, can't ratify result\");\n    $success();\n    return false;\n  }\n  var local = cti.store.CurrentItem.internalData;\n  var remote = result.data.payload.markingIn;\n  \n  if (local.MKCOYN == remote.MKCOYN && local.MKLOCN == remote.MKLOCN && local.MKINUM == remote.MKINUM && local.MKACNO == remote.MKACNO) {\n    console.log(\"debug:: Item in result package matches current item - look for defender\");\n    for (var k in cti.store.CurrentItem.defenders) {\n      var thisDefender = cti.store.CurrentItem.defenders[k];\n      if (thisDefender.number == result.data.payload.defender.DFNMBR) {\n\t    console.log(\"debug:: Found matching defender: \" + thisDefender.name);\n        thisDefender.status = result.success ? \"complete\" : \"failed\";\n        thisDefender.updateResult = result.data.reason;\n        if (!result.success) {\n          \tcti.utils.callAction('show-notification', { name: \"Warning\", title: \"Unable to action\", text: result.data.reason + \" for \" + (thisDefender.name || \"this defender\") });\n          \n        }\n        break;\n      }\n    }\n  }\n  else {\n    console.log(\"debug:: Item in result package does not match current item, aborting\");\n  }\n}\n$success();"},"_auto_id_":"ffbae7fa-6a69-4ca4-a752-84d945954df6"},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"console.log(\"fail\");\n$success();"},"_auto_id_":"1f48d917-deee-4112-ac9e-ba1b04e4a486","actions":[]}]}],"name":"SaveService"}],"dataflows":[],"config":[{"name":"ScottCo","type":"integration","item-type":"api","_auto_id_":"738ca597-42d0-4ee3-9c7c-16dd2a3065bf","headers":{},"params":[],"operations":[{"ttlMinutes":60,"name":"markingin","summary":"Retrieve the marking in record","path":"selectmarkingin","method":"POST","content-type":"application/json","params":[{"name":"companyNo","description":"Company the documents are to be served for","type":"string","typeConfig":{},"in":"body","required":true},{"name":"companyId","description":"Company 1=Scott Co 2=AAH 3=Test","type":"string","typeConfig":{},"in":"body","default":"3"},{"name":"applicationkey","description":"App access key","type":"string","typeConfig":{},"in":"body"},{"name":"locationNo","description":"Company location","type":"string","typeConfig":{},"in":"body"},{"name":"markingInNo","description":"Marking in reference number","type":"string","typeConfig":{},"in":"body"},{"name":"agentNo","description":"Agent identifier","type":"string","typeConfig":{},"in":"body"}],"$open":true},{"ttlMinutes":60,"name":"getconfig","summary":"Get configuration options","path":"config","method":"POST","content-type":"application/json","params":[{"name":"companyId","description":"Company","type":"string","typeConfig":{},"in":"body"},{"name":"applicationkey","description":"API key to allow use of services","type":"string","typeConfig":{},"in":"header"}],"$open":false}],"url":"{{$store.pages.Settings.APIAddress}}"},{"name":"Warning","type":"notification","item-type":"app-notification","_auto_id_":"ce3cc8fe-9ed3-41dc-b0b3-667266fddda6","options":{"autoDismiss":true,"closeButton":true},"style":"warning","title":"Unable to complete action","text":"Please try again later"},{"name":"image_edinburgh","type":"style","item-type":"image-asset","_auto_id_":"b402c8b2-81b8-4527-a289-83049320bae8","fileName":"scottandco.jpg"},{"name":"cssAdditional","type":"style","item-type":"css","_auto_id_":"301886a6-71f9-4735-b0d7-74d717355e3a","content":".button {\n  color: #0072C6 !important;\n  width:200px;\n  height:48px;\n  padding-top:10px;\n  font-size:1.2em;\n  margin-bottom:5vh;\n}\n.inline-button {\n\tcolor: #0072C6 !important;\n}\n@media screen and (min-width: 640px) {\n    .inline-button {\n      width:200px;\n      height:48px;\n      padding-top:10px;\n      font-size:1.2em;\n    }\n}\n\n#btnNav {\n  float:right;\n  margin-top:34px;\n}\n\n.md-button-container {\n    margin: 10px 0;\n    display: inline;\n}\n#htmlDefender {\n  width:60%;\n  display:inline-block;\n}\n\nsection#footer {\n    background: transparent;\n  \tborder:0;\n}\n\nmd-question[required=true] label {\n    color: #a94442;\n}\n\n.has-success .form-control:focus {\n    border-color: #009C87;\n}\n\nspan.required-asterix.fa.fa-star {\n    display: none!important;\n}\n\n.has-success .form-control {\n    border-color: #009C87;\n}\n\n.form-input-error {\n    font-size: 10px;\n}\n\n.has-success .checkbox, .has-success .checkbox-inline, .has-success .control-label, .has-success .help-block, .has-success .radio, .has-success .radio-inline, .has-success.checkbox label, .has-success.checkbox-inline label, .has-success.radio label, .has-success.radio-inline label {\n    color: #009C87;\n}\n\n/*\n.flexbox-container .navbar-default.row-item:last-child .btn:not(.minimal):hover {\n    background-color: #009C87;\n}\n*/\n\nsection#title_bar {\n    background-color: #002768;\n  \tcolor:white;\n  \tborder:0;\n  \tbox-shadow: 0 5px 10px rgba(0,0,0,0.19), 0 3px 3px rgba(0,0,0,0.23);\n}\n\nsection#title_barÃÂ .content-block {\n    margin-bottom:0;\n}\n\n.iconButton {\n    color: white!important;\n    font-size: 1.8em;\n}\n\n.iconButton a {\n    color: white;\n}\n\n.action-button {\n    font-size: 1.4em;\n  \tmin-width:130px;\n}\n\nsection#title_bar > div:first-child {\n    position: absolute;\n    left: 0;\n    width: 2em;\n}\n\nsection#title_bar > div:last-child {\n    position: absolute;\n    right: 2em;\n    width: 2em;\n}\n\n.nopadding {\n    padding: 0!important;\n}\n\nmd-content#htmlActionDetails .content-block {\n    padding: 20px;\n}\n\nmd-content#htmlBanner .content-block {\n    background-color: #009C87;\n    padding: 10px;\n    margin: 0;\n    color: white;\n    text-align: center;\n}\n\ndiv#mapcontainer {\n    height: 40vh;\n}\n\nbutton.dropdown-toggle {\n    background-color: transparent!important;\n    padding: 6px 25px 6px 12px;\n}\n\n.image-viewer-container.logo {\n    padding: 10px;\n    text-align: center;\n    background-color: #f6f6f5;\n}\n\n.image-viewer-container.logo img{\n\twidth:75vw;\n}\n\nsection#row_AppName {\n    background-color: #002768;\n    border: none;\n\tcolor: white;\n    padding-top: 4px;\n    padding-bottom: 4px;\n}\nsection#row_search {\n    background-color: transparent;\n  \tborder:0;\n    box-shadow: 5px 5px 10px rgba(0,0,0,0.19), 5px 3px 3px rgba(0,0,0,0.23);\n}\nsection#row_Company {\n    background-color: transparent;\n    border: none;\n\tcolor: white;\n    padding-top: 8px;\n}\n\nmd-question#MarkingInNumber {\n    flex-basis: 75%;\n}\n#row_Company > md-question {\n    flex-basis: 40%;\n}\n\n\ndiv#btnSearchAction {\n    width: 2em;\n}\n\na#btnSearchAction {\n    padding: 0;\n    margin-top: 10px;\n}\n\ndiv#Home, div#Search {\n    background-image: url('user-assets/scottandco.jpg');\n    background-size: cover;\n    background-position-x: 80%;\n}\n\ninput#MarkingInNumber, select#Company, select#CompanyLocation {\n  /*\n    background: transparent;\n    color: white;\n  */\n    border: 1px solid white;\n  \ttext-align: center;\n}\n\nbutton.btn.btn-default.dropdown-toggle {\n    background: transparent!important;\n    padding: 6px 25px 6px 12px;\n  \tcolor:black;\n}\n\n.content-block {\n    margin-bottom: 0!important;\n    padding-bottom: 0!important;\n}"},{"name":"cssMain","type":"style","item-type":"css","_auto_id_":"044a2840-9e6c-48fb-b571-f7b6273183b9","content":"[name=\"pageForm\"] {\n}\n\n.navbar-default {\n\tflex: inherit;\n}\n.navbar-default md-content[item-type=\"html\"] {\n  font-size:16pt;\n  margin-top:10px;\n}\n\n.navbar-default .md-button-container {\n  margin-left:8px !important;\n  margin-right:8px !important;\n}\n\n.switch-container {\n    display: initial;\n    text-align: left;\n    margin-top: 0;\n}\np.version {\n\twidth:100%;\n\ttext-align:center;\n  \tcolor:#bbb;\n  \tfont-size:10pt;\n}\n\n\nsection.static-item {\n\tdisplay:block;\n\tflex:none;\n}\nsection[item-type=\"static\"] {\n\tborder: none !important;\n\tpadding: 0 !important;\n}\n\n.defender-container {\n  border:1px #dddddd solid;\n  padding:5px;\n}\n.defender-container-pending {\n  border-left:5px orange solid;\n}\n.defender-container-failed {\n  border-left:5px red solid;\n}\n.defender-container-complete {\n  border-left:5px green solid;\n}\n.defender-container-unavailable {\n  border-left:5px grey solid;\n  color:grey;\n}\n.defender-name {\n  display:inline-block;\n  font-size:1.1em;\n  font-weight:700;\n  width:35%;\n}\n.defender-address {\n  display:inline-block;\n  font-size:1.1em;\n  width:60%;\n}\n.defender-outcome {\n  text-indent:30px;\n  margin-top:10px;\n  color:gray;\n}\n.defender-list > div > ul {\n    padding: 0;\n}\n.defender-list > div > ul li {\n  list-style-type:none;\n  /*padding:10px 4px;*/\n}"},{"name":"cssPopup","type":"style","item-type":"css","_auto_id_":"3471835d-6673-4b6c-a47c-d95959be5e85","content":"ct-popup-box div.popupBG {\n    display: flex;\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100vw;\n    height: 100vh;\n    background-color: rgba(0, 0, 0, 0.6);\n    z-index: 999\n}\nct-popup-box div.popupBG div.popupBox {\n    width: 80vw;\n    background-color: white;\n    margin: auto;\n    display: flex;\n    flex-wrap: wrap;\n    justify-content: center\n}\nct-popup-box md-content {\n    margin: 2vh auto;\n    text-align: center;\n    padding: 3vh 4vw 0\n}\nct-popup-box .md-button-container {\n    margin: 0 auto !important;\n    width: 72vw\n}\nct-popup-box .md-button-container a,\nct-popup-box .md-button-container a:hover {\n    color: white !important;\n    width: 100%;\n    border: none;\n    padding: 2vh 0;\n    margin-bottom: 2vh\n}\nct-popup-box div[classes=\"green\"] a,\nct-popup-box div[classes=\"green\"] a:hover {\n    background-color: green !important\n}\nct-popup-box div[classes=\"red\"] a,\nct-popup-box div[classes=\"red\"] a:hover {\n    background-color: red !important\n}\nct-popup-box#popFailReason md-content {\n    margin: 0 auto 1vh;\n    padding: 2vh 4vw 0\n}\nct-popup-box#popFailReason .md-button-container a,\nct-popup-box#popFailReason .md-button-container a:hover {\n    color: black !important;\n    border: 1px solid black;\n    padding: 1vh 0;\n    margin-bottom: 1vh;\n    white-space: normal\n}\nct-popup-box#popFailReason div[classes=\"red\"] a,\nct-popup-box#popFailReason div[classes=\"red\"] a:hover {\n    color: white !important;\n    border: 1px solid red\n}\n.box {\n    width: 50vw;\n    height: 15vh;\n    display: flex;\n    flex-direction: column;\n    border: 1px solid #d3d3d3;\n    float: left;\n    background-color: white;\n    text-align: center\n}\n.box:nth-child(3),\n.box:nth-child(4) {\n    border-left: none\n}\n.box h3 {\n    word-wrap: break-word;\n    white-space: pre-line;\n    margin: auto 2vw;\n    font-size: 18px\n}\n.box h3 span {\n    font-size: 62px\n}\n.box.btn {\n    width: 30vw;\n    background-color: #3E788F\n}\n.box.btn h3 {\n    color: white;\n    line-height: 28px\n}\n \n"},{"name":"cssApp","type":"style","item-type":"css","_auto_id_":"6a27168a-f86e-4274-a63e-3022f81e17d3","content":".item-label {\n  font-size:0.8em;\n}\n.item-value {\n  font-size:1.2em;\n  font-weight:700;\n}\nspan.item-label {\n  display:inline-block;\n  min-width:40%;\n}\n.label-area {\n  display:inline-block;\n  width:40%;\n  font-size:0.8em;\n}\n.value-area {\n  display:inline-block;\n  font-weight:700;\n  font-size:1.0em;\n}\n"},{"name":"cssResponsiveStyles","type":"style","item-type":"css","_auto_id_":"246d2cad-5260-4d97-8c5a-f3381b1d9ca9","content":"@media only screen and (orientation: landscape) {\n\t#htmlMap {\n      float:right;\n  \t}\n  \t#htmlActionDetails {\n      /*float:left;*/\n  \t}\n  \tdiv#mapcontainer {\n      height:70vh;\n      width:60vw;\n  \t}\n}\n"},{"name":"function_init_map","type":"scripting","item-type":"function","_auto_id_":"c60f129a-8311-4bec-a0a5-3559af555139","sync":true,"params":[],"content":"if (!cti.store.CurrentItem._defenders || cti.store.CurrentItem._defenders.length == 0) {\n\treturn false;\n}\n\nconsole.log(\"init_map, invoke geocoder\");\n// set up our geoCoder\nvar geocoder = new google.maps.Geocoder();\nvar map = undefined;\nvar mypos = undefined;\nvar defenderIndex = -1;\n\nfunction processNextAddress() {\n  defenderIndex++;\n  if (defenderIndex >= cti.store.CurrentItem._defenders.length || defenderIndex > 2) { return false; }\n  \n  var thisDefender = cti.store.CurrentItem._defenders[defenderIndex];\n  if (thisDefender.position_) {\n    console.log(\"debug:: Plot location at cached position: \" + JSON.stringify(thisDefender.position));\n    var marker = new google.maps.Marker({\n      position: thisDefender.position,\n      map: map,\n      animation: google.maps.Animation.DROP\n    });\n    processNextAddress();\n  }\n  else {\n    geocoder.geocode({'address': thisDefender.postcode}, function(results, status) {\n      if (status == google.maps.GeocoderStatus.OK) {\n\t    var thisLocation = new google.maps.LatLng(results[0].geometry.location.lat(), results[0].geometry.location.lng());\n\t    console.log(\"debug:: Plot new position: \" + JSON.stringify(thisLocation));\n        \n        /*\n        if (!cti.store.PositionCache) {\n          cti.store.PositionCache = { }\n        }\n        var locationItem = { \"lat\": thisLocation.lat, \"lng\": thisLocation.lng }\n        cti.store.PositionCache[thisDefender.postcode] = locationItem;\n        */\n        \n        // If we didn't find current location, center map on first defender address\n        if (!map) {\n          map = new google.maps.Map(document.getElementById('mapcontainer'), {\n              zoom: 12,\n              center: thisLocation,\n              mapTypeId: 'roadmap'\n          });\n        }\n        \n        var label = (defenderIndex+1).toString();\n        var infoWindow = new google.maps.InfoWindow({\n          content: '<div><b>Defender</b><br/>' + thisDefender.name+ '<br/>' + thisDefender.address1 + '</div>'\n        });\n        var marker = new google.maps.Marker({\n          position: thisLocation,\n          map: map,\n          label: label,\n          animation: google.maps.Animation.DROP\n        });\n        marker.addListener('click', function() { infoWindow.open(map, marker); });\n      }\n      else {\n\t    console.log(\"debug:: Unable to get position: \" + JSON.stringify(status));\n      }\n      setTimeout(processNextAddress, 100);\n    });\n  }\n}\n\n\nif (navigator.geolocation) {\n  navigator.geolocation.getCurrentPosition(function(position) {\n    mypos = { lat: position.coords.latitude, lng: position.coords.longitude };\n    /*\n    map = new google.maps.Map(document.getElementById('mapcontainer'), {\n        zoom: 12,\n      \tcenter: pos,\n        mapTypeId: 'roadmap'\n    });\n    */\n    if (!cti.store.LocationHistory) {\n      cti.store.LocationHistory = [];\n    }\n    //cti.store.LocationHistory.push({ \"location\": mypos, \"date\": new Date() });\n    console.log(\"debug:: Curent location: \" + JSON.stringify(mypos));\n\tprocessNextAddress();\n  }, function() {\n    console.log(\"debug:: Unable to get current position, acquisition failed\");\n\tprocessNextAddress();\n  });\n}\nelse {\n    console.log(\"debug:: Unable to get current position, not supported\");\n\tprocessNextAddress();\n}\n\n","actions":[]},{"name":"fnFilterCompanyLocations","type":"scripting","item-type":"function","_auto_id_":"1fc2c9fa-e604-4ef2-b362-edcad418068e","sync":true,"params":[],"content":"// fnFilterCompanyLocations\n// Ensure location cascade is correct for the selected company\nif (cti.store.variables.FilterLocations === undefined) {\n  cti.store.variables.FilterLocations = [];\n}\n\nfunction buildFilterList(parentId) {\n  cti.store.variables.FilterLocations.splice(0, cti.store.variables.FilterLocations.length);\n  if (cti.store.Config.locations !== undefined && parentId !== undefined && parentId != 0) {\n    for (var k in cti.store.Config.locations) {\n      var thisLocation = cti.store.Config.locations[k];\n      if (thisLocation.parentId == parentId) {\n        cti.store.variables.FilterLocations.push(thisLocation);\n      }\n    }\n  }\n}\n\n// If company select container has been initialised...\nif (cti.store.pages !== undefined && cti.store.pages.Search !== undefined) {\n  // If company is not selected, make sure cascade selection is clear\n  if (cti.store.pages.Search.Company === undefined || cti.store.pages.Search.Company == null || cti.store.pages.Search.Company.value == 0) {\n    cti.store.variables.FilterLocations = [];\n    delete cti.store.pages.Search.Location;\n  }\n  else {\n    // Filter the list if any matching location options are available\n    var selectedCompany = cti.store.pages.Search.Company.value;\n    \n    if (cti.store.variables.FilterLocations.length == 0) {\n      buildFilterList(selectedCompany);\n    }\n    else if (selectedCompany != cti.store.variables.FilterLocations[0].parentId) {\n      // Selection list is likely invalid - clear it and enforce re-select\n      delete cti.store.pages.Search.Location;\n      buildFilterList(selectedCompany);\n    }\n    \n  }\n  //cti.utils.updatePage();\n}\n"},{"name":"fnCancelPopup","type":"scripting","item-type":"function","_auto_id_":"6861166f-e288-4aaf-b23d-989ee4671ed5","sync":false,"params":[{"name":"popupId","description":"Id of the element"}],"content":"// fnCancelPopup\n// Closes active popup message \"window\"\nvar popup = document.getElementById(popupId);\nif (popup !== undefined && popup !== null)\n\tpopup.toggle();"},{"name":"fnClearCurrentItem","type":"scripting","item-type":"function","_auto_id_":"6a5aba97-3d9c-49c3-9033-44447548ccef","sync":true,"params":[],"content":"// fnClearCurrentItem\n// Clear the current marking in record either after processed, or prior to searching for a new one\ndebugger;\nconsole.log(\"debug:: Clear current item\");\nif (cti.store.pages && cti.store.pages.Search) {\n  delete cti.store.pages.Search.Company;\n  delete cti.store.pages.Search.CompanyLocation;\n  delete cti.store.pages.Search.MarkingInNumber;\n  if (cti.store.variables.FilterLocations) {\n    cti.store.variables.FilterLocations.splice(0, cti.store.variables.FilterLocations.length);\n  }\n}\ndelete cti.store.CurrentItem;\ndelete cti.store.CurrentDefender;\ncti.utils.destroyPageData(\"ActionDetail\");\ncti.utils.destroyPageData(\"DefenderOutcome\");\n\nthis.$success();"},{"name":"fnSetCurrentItem","type":"scripting","item-type":"function","_auto_id_":"f59551cd-dafc-47e0-99d2-9266120ad1b0","sync":true,"params":[],"content":"// fnSetCurrentItem\n// Puts the searched for marking in request into the model\n\nconsole.log(\"debug:: Setting current item\");\n\nfunction addText(address, s) {\n\tif (s === undefined || s == null || s.trim() == '') { return address; }\n\tif (address.trim() == '') {  return s }\n\telse { return address + ', ' + s.trim(); }\n}\n\ndebugger;\ncti.store.CurrentItem = JSON.parse(JSON.stringify(cti.store.api.ScottCo.markingin.data));\ncti.store.CurrentItem.document = { \"DTDESC\": \"\", \"DNNAME\": cti.store.CurrentItem.documentName };\n\ncti.store.variables.DefenderTerm = \"Defenders\";\nif (cti.store.CurrentItem.documentType == 1) {\n\tcti.store.variables.DefenderTerm = \"Witnesses\";\n}\n\nvar address = '';\naddress = addText(address, cti.store.CurrentItem.address1);\naddress = addText(address, cti.store.CurrentItem.address2);\naddress = addText(address, cti.store.CurrentItem.address3);\naddress = addText(address, cti.store.CurrentItem.address4);\naddress = addText(address, cti.store.CurrentItem.postcode);\n\nif (address == '') {\n  address = '(no address on file)';\n}\ncti.store.CurrentItem.fullAddress = address;\n\nif (cti.store.CurrentItem.defenders) {\n\tcti.store.CurrentItem._defenders = JSON.parse(JSON.stringify(cti.store.CurrentItem.defenders));\n\n\tcti.store.CurrentItem.defenders.splice(0, cti.store.CurrentItem.defenders.length);\n}\nelse if (cti.store.CurrentItem._defenders) {\n\tcti.store.CurrentItem._defenders.splice(0, cti.store.CurrentItem._defenders.length);\n}\n\n\nfor (var k in cti.store.CurrentItem._defenders) {\n  var thisDefender = cti.store.CurrentItem._defenders[k];\n  thisDefender.outcomeSummary = 'Please select to record execution details...';\n  address = '';\n  address = addText(address, thisDefender.address1);\n  address = addText(address, thisDefender.address2);\n  address = addText(address, thisDefender.address3);\n  address = addText(address, thisDefender.address4);\n  address = addText(address, thisDefender.postcode);\n  thisDefender.fullAddress = address;\n  if (thisDefender.postcode && cti.store.PositionCache && cti.store.PositionCache[thisDefender.postcode]) {\n    thisDefender.position = cti.store.PositionCache[thisDefender.postcode];\n  }\n}\n\nfor (var k1 in cti.store.Config.documentTypes) {\n  if (cti.store.Config.documentTypes[k1].value == cti.store.CurrentItem.documentType) {\n    cti.store.CurrentItem.documentTypeName = cti.store.Config.documentTypes[k1].label;\n    cti.store.CurrentItem.document.DTDESC = cti.store.Config.documentTypes[k1].label;\n    break;\n  }\n}\n\nthis.$success();"},{"name":"fnSetDefenders","type":"scripting","item-type":"function","_auto_id_":"ea8c0d0f-1253-4187-9726-60a1af25cf6a","sync":true,"params":[],"content":"// fnSetDefenders\n\nfunction addText(address, s) {\n\tif (s === undefined || s == null || s.trim() == '') { return address; }\n\tif (address.trim() == '') {  return s }\n\telse { return address + ', ' + s.trim(); }\n}\n\n\nif (!cti.store.CurrentItem.defenders || cti.store.CurrentItem.defenders.length < 1) {\n\n\tsetTimeout(function() {\n      \n    cti.store.CurrentItem.defenders = JSON.parse(JSON.stringify(cti.store.api.ScottCo.markingin.data.defenders))\n\n    for (var k in cti.store.CurrentItem.defenders) {\n      var thisDefender = cti.store.CurrentItem.defenders[k];\n      thisDefender.outcomeSummary = thisDefender.outcomeSummary || 'Please select to record execution details...';\n      address = '';\n      address = addText(address, thisDefender.address1);\n      address = addText(address, thisDefender.address2);\n      address = addText(address, thisDefender.address3);\n      address = addText(address, thisDefender.address4);\n      address = addText(address, thisDefender.postcode);\n      thisDefender.fullAddress = address;\n      if (thisDefender.postcode && cti.store.PositionCache && cti.store.PositionCache[thisDefender.postcode]) {\n        thisDefender.position = cti.store.PositionCache[thisDefender.postcode];\n      }\n    }\n      \n    }, 500);\n}\n"},{"name":"fnSubmitSearch","type":"scripting","item-type":"function","_auto_id_":"1f0b1960-6082-408a-a1fd-a099ae3ee565","sync":false,"params":[],"content":"if (cti.store.Config === undefined) {\n\tvar popup = document.getElementById(\"popNeedConfig\");\n\tif (popup !== undefined && popup !== null)\n\t\tpopup.toggle();\n  \n}\nelse {\n  console.log(\"debug:: Invoking submit search\");\n\tcti.utils.callAction(\"call-actionflow\", { name: \"RequestAction\" });\n}"},{"name":"ScottCoOffline","type":"integration","item-type":"offline-api","_auto_id_":"41effe71-262e-442e-8ebb-2764c232e9d8","headers":{},"params":[],"operations":[{"ttlMinutes":120,"name":"save","summary":"Save a completed action to the server","path":"save","method":"POST","content-type":"application/json","params":[{"name":"payload","description":"Completed action details as captured by the user","type":"string","typeConfig":{},"in":"body"},{"name":"companyId","description":"Operation mode - live or test","type":"string","typeConfig":{},"in":"body"},{"name":"applicationkey","description":"API key","type":"string","typeConfig":{},"in":"header"}],"$open":true}],"url":"{{$store.pages.Settings.APIAddress}}"},{"name":"fnSaveSettings","type":"scripting","item-type":"function","_auto_id_":"bd3b8cc1-3a36-4c46-b177-fdf75a3bef33","sync":true,"params":[],"content":"// Update the config options used by the app, if we have a valid API result\ndebugger;\n\nif (cti.store.Config === undefined) { cti.store.Config = {}; }\n\nfunction clone(obj) {\n    if (null == obj || \"object\" != typeof obj) return obj;\n    var copy = obj.constructor();\n    for (var attr in obj) {\n        if (obj.hasOwnProperty(attr)) copy[attr] = obj[attr];\n    }\n    return copy;\n}\nfunction validateEntry(field, entryTitle) {\n\tvar result = cti.store.pages && cti.store.pages.Settings && cti.store.pages.Settings[field];\n  if (!result) {\n\tcti.utils.callAction('show-notification', { name: \"Warning\", title: \"Information Missing\", text: \"Please enter your \"+ (entryTitle || field) +\" name.\" });\n  }\n  return result;\n}\nfunction lookupEntry(field, lookupArray, entryTitle) {\n\tvar value = cti.store.pages.Settings[field].toLowerCase();\n  for (var i = 0; i < cti.store.Config[lookupArray].length; i++) {\n    if (cti.store.Config[lookupArray][i].label.toLowerCase() == value) {\n      return cti.store.Config[lookupArray][i].value;\n    }\n  }\n\tcti.utils.callAction('show-notification', { name: \"Warning\", title: \"User Unknown\", text: \"Please check the \"+ (entryTitle || field) +\" name as the one you entered was not found.\" });\n  return undefined;\n}\n\nif (!validateEntry('SheriffOfficer', 'Sheriff Officer') || !validateEntry('Witness')) {\n  this.$fail();\n  return false;\n}\n\nif (cti.store.pages.Settings.CompanyMode == undefined || cti.store.pages.Settings.CompanyMode.value == undefined) {\n\tcti.utils.callAction('show-notification', { name: \"Warning\", title: \"Information Missing\", text: \"Please select the company you are acting for.\" });\n  this.$fail();\n  return false;\n}\n\nvar usingOldConfig = false;\nvar haveConfig = (cti.store.api.ScottCo !== undefined && cti.store.api.ScottCo.getconfig !== undefined && cti.store.api.ScottCo.getconfig.success);\n\nif (haveConfig) {\n  \t// TODO Clone the object instead of just referencing it\n\tcti.store.Config = clone(cti.store.api.ScottCo.getconfig.data);\n  \n\t// Clear the API result set\n\tdelete cti.store.api.ScottCo.getconfig;\n}\nelse if (cti.store.Config === undefined || cti.store.Config.sheriffOfficers === undefined) {\n  \t// If we dont have previous config to refer to, do not carry on\n\tcti.utils.callAction(\"show-notification\", { name: \"Warning\", title: \"Configuration Problem\", text: \"We were unable to get the latest configuration information, please try again.\" });\n  this.$fail();\n  return false;\n}\nelse {\n\tusingOldConfig = true;\n}\n\nfunction pad(value) {\n  if (value >= 10) { return value; } else { return '0' + value.toString(); }\n}\n\n// Validate the username that was entered (Sheriff officer)\nvar soNumber = lookupEntry('SheriffOfficer', 'sheriffOfficers', 'Sheriff Officer');\n\n// Validate the witness name\nvar witnessNumber = lookupEntry('Witness', 'witnesses');\n\nif (soNumber === undefined || witnessNumber === undefined) {\n  this.$fail();\n  return false;\n}\n\nif (usingOldConfig) {\n\tcti.utils.callAction(\"show-notification\", { name: \"Warning\", title: \"Configuration Problem\", text: \"We were unable to get the latest configuration information, some options may be unavailable.\" });\n}\n\n// Move back to the search page\ncti.store.Config.soNumber = soNumber;\ncti.store.Config.witnessNumber = witnessNumber;\ncti.store.Config.soName = cti.store.pages.Settings.SheriffOfficer;\ncti.store.Config.witnessName = cti.store.pages.Settings.Witness;\ncti.store.Config.company = cti.store.pages.Settings.CompanyMode.value;\ncti.store.Config.companyName = cti.store.pages.Settings.CompanyMode.label;\n\ncti.store.Config.DayList = [];\ncti.store.Config.MonthList = [];\ncti.store.Config.YearList = [];\nfor (var i = 1; i < 32; i++) {\n  cti.store.Config.DayList.push({ \"label\": i.toString(), \"value\": pad(i) });\n}\nvar dt = new Date();\nvar intialYear = dt.getFullYear()-17;\nfor (var i = intialYear; i > (intialYear-100); i--) {\n  cti.store.Config.YearList.push({ \"label\": i.toString(), \"value\": i });\n}\ncti.store.Config.MonthList.push({ \"label\": \"January\", \"value\": \"01\" });\ncti.store.Config.MonthList.push({ \"label\": \"February\", \"value\": \"02\" });\ncti.store.Config.MonthList.push({ \"label\": \"March\", \"value\": \"03\" });\ncti.store.Config.MonthList.push({ \"label\": \"April\", \"value\": \"04\" });\ncti.store.Config.MonthList.push({ \"label\": \"May\", \"value\": \"05\" });\ncti.store.Config.MonthList.push({ \"label\": \"June\", \"value\": \"06\" });\ncti.store.Config.MonthList.push({ \"label\": \"July\", \"value\": \"07\" });\ncti.store.Config.MonthList.push({ \"label\": \"August\", \"value\": \"08\" });\ncti.store.Config.MonthList.push({ \"label\": \"September\", \"value\": \"09\" });\ncti.store.Config.MonthList.push({ \"label\": \"October\", \"value\": \"10\" });\ncti.store.Config.MonthList.push({ \"label\": \"November\", \"value\": \"11\" });\ncti.store.Config.MonthList.push({ \"label\": \"December\", \"value\": \"12\" });\n\ncti.store.Config.YesNoSelect = [{ \"label\": \"No\", \"value\": 0 }, { \"label\": \"Yes\", \"value\": 1 }];\n\ncti.utils.callAction(\"go-to-page\", {\"name\":\"Search\"});\nthis.$success();\n"},{"name":"GoogleMapping","type":"integration","item-type":"url","_auto_id_":"388a5d11-fc41-48cb-96e8-a8a0eb94dcf1","params":{},"target":"_system","url":"http://maps.google.com"},{"name":"Info","type":"notification","item-type":"app-notification","_auto_id_":"e7c36a52-192e-4a46-ab64-e45fe20bf044","options":{"autoDismiss":true,"closeButton":true},"style":"info","title":"Information","actions":[]}],"components":[{"name":"ct_popup_box","description":"","icon":"fa-puzzle-piece","tagName":"ct-popup-box","type":"web-component","typeVersion":"1","format":"javascript","annotations":{"attributes":[{"name":"id","description":"","type":"string","enum":null,"required":true}],"functions":[{"name":"toggle","description":"Toggles the menu opened and closed based on the value\nof the this.opened property (initially set to false)","params":[{"name":"containerid","description":"id of container the popup is in","type":"string","enum":null,"required":true}],"returnType":"void","returnEnum":null}]},"_auto_id_":"c04df03e-20ca-4f06-815b-ed42ca534a76","valid":true,"files":{"original":"ct_popup_box.js","transpiled":"ct_popup_box.output.js"},"userConfig":{}}],"icondata":"scottco_app2.png","hostContext":0,"minimumStudioVersion":"3.1.0","id":"381e143a-9717-4b08-a0b0-ed8cd0eebf5c","packageId":"com.commontime.scottco.service","lastSchemaUpgradeDate":"2017-04-21 08:27:30","jwt":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJhcHBfaWQiOiIzODFlMTQzYS05NzE3LTRiMDgtYTBiMC1lZDhjZDBlZWJmNWMiLCJhcHBfbmFtZSI6IlNlcnZpY2UiLCJidWlsZF9pZCI6IjRlOTJkNTU5LWJmYWEtNDk5MS1hMGRmLTk2MGQxZjgzNDc3MiIsImNsaWVudF9pZCI6ImUxOGYyMWRjLTA3NDAtNDYwMi1iMWE2LTNlYTI2Zjg0NzQwNyIsImNsaWVudF9zZWNyZXQiOiJUR1o2TUZkaFREVnhTbUpEVFRSSGIxWkRTRkpoZHowOSIsImV4cCI6MTYwOTI4NjQwMCwiZnJlcXVlbmN5IjoyMTYwMDAwMDAsImhhc2giOiI0YTE5MTNjMDdkMmUxMDllNmNlOGI4YWU3MmUxMDgzM2M4M2RlMTBjYzI1ZjVjOTJjNzQ1NjMyNjAxZTgxNzAxIiwibGljX2V4cCI6MTYwNjY5NDQwMCwibHBfaWQiOiI1NDA1ZDg4NS0zZjQ4LTQ0NTctODhlMC1mMzY4MzE5MTcyOWEiLCJwYWNrYWdlX2lkIjoiY29tLmNvbW1vbnRpbWUuc2NvdHRjby5zZXJ2aWNlIiwicmVmcmVzaF90b2tlbiI6IlJUQjNiMEZ3Y2xkTWRqRnBjbWhaTW1OMVJsRkJSMGRQU1ZkMGMzUXlkREZOVUVsaWFuRXdaMU5FVVQwPSIsInR5cGUiOiJmdWxsIiwiaWF0IjoxNTc1NDY3MjcxfQ.s8cgLflpDu3rAIcLsrB_4rN_4MxdpumPjyEBl-Rcc5n7yzkm3GAwqgQVjYlKa-4rbR3MevWAyMhJ2UeJLAmQXjd_ibGyNHN8x-D8NlZ6bBh5GEPWzoQ4ltp_4SEXqM5f9r6WAlVt8M-OA9Fj0tXwME1CUowzVL1n4eM1YjCxjpY1yiTzJmwerCE3ZE2BxZ0D8WBekXHAFQKaZS2ZO2HPTmaGOWzTySoCDLLmRcLKxpY80NEffG8g-WVtlh_Gy2kb3hB-rSF1C2EAZaSM4JSfRybC-tdDLZfXz21Fhl8-qdLXDF_5r82gVINmLQLFnvJ2ytdaIypJMTZK7Wsln8xIAg","buildId":"4e92d559-bfaa-4991-a0df-960d1f834772"}